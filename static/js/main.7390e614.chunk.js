(this["webpackJsonpthe-dojo"]=this["webpackJsonpthe-dojo"]||[]).push([[0],{36:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var c=n(2),s=n.n(c),r=n(29),a=n.n(r),i=(n(36),n(16)),u=n(17),j=n(5),o=n(13),l=n(20);n(61),n(38),n(62);l.a.initializeApp({apiKey:"AIzaSyBwPKqowgFJDC-zO_cAiPgDXHgibvGWqv8",authDomain:"the-dojo-76b39.firebaseapp.com",projectId:"the-dojo-76b39",storageBucket:"the-dojo-76b39.appspot.com",messagingSenderId:"830539958632",appId:"1:830539958632:web:435ff56d7cf53273352edd"});var b=l.a.firestore(),d=l.a.auth(),O=l.a.storage(),h=(l.a.firestore.Timestamp,n(1)),p=Object(c.createContext)(),x=function(e,t){switch(t.type){case"LOGIN":return Object(o.a)(Object(o.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(o.a)(Object(o.a)({},e),{},{user:null});case"AUTH_IS_READY":return Object(o.a)(Object(o.a)({},e),{},{user:t.payload,authIsReady:!0});default:return e}},f=function(e){var t=e.children,n=Object(c.useReducer)(x,{user:null,authIsReady:!1}),s=Object(j.a)(n,2),r=s[0],a=s[1];return Object(c.useEffect)((function(){var e=d.onAuthStateChanged((function(t){a({type:"AUTH_IS_READY",payload:t}),e()}))}),[]),Object(h.jsx)(p.Provider,{value:Object(o.a)(Object(o.a)({},r),{},{dispatch:a}),children:t})},v=function(){var e=Object(c.useContext)(p);if(!e)throw new Error("useAuthContext must used inside an AuthContextProvider");return e},m=(n(41),n(42),function(){return Object(h.jsx)("div",{children:"Dashboard"})}),g=(n(43),function(){return Object(h.jsx)("div",{children:"Create"})}),y=n(19),N=n(15),S=n.n(N),w=(n(46),function(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(j.a)(r,2),i=a[0],u=a[1],o=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(j.a)(r,2),i=a[0],u=a[1],o=v().dispatch,l=Object(c.useState)(!1),O=Object(j.a)(l,2),h=O[0],p=O[1],x=function(){var e=Object(y.a)(S.a.mark((function e(t,n){var c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(null),u(!0),e.prev=2,e.next=5,d.signInWithEmailAndPassword(t,n);case 5:return c=e.sent,e.next=8,b.collection("users").doc(c.user.uid).update({online:!0});case 8:o({type:"LOGIN",payload:c.user}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),h||s(e.t0.message);case 14:h||u(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return function(){return p(!0)}}),[]),{login:x,error:n,isPending:i}}(),l=o.login,O=o.error,p=o.isPending;return Object(h.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),l(n,i)},children:[Object(h.jsx)("h2",{children:"Login"}),Object(h.jsxs)("label",{children:[Object(h.jsx)("span",{children:"Email:"}),Object(h.jsx)("input",{required:!0,type:"email",onChange:function(e){return s(e.target.value)},value:n})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("span",{children:"Password:"}),Object(h.jsx)("input",{required:!0,type:"password",onChange:function(e){return u(e.target.value)},value:i})]}),!p&&Object(h.jsx)("button",{className:"btn",children:"Login"}),p&&Object(h.jsx)("button",{className:"btn",disabled:!0,children:"Loading..."}),O&&Object(h.jsx)("div",{className:"error",children:O})]})}),P=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(j.a)(r,2),i=a[0],u=a[1],o=v().dispatch,l=Object(c.useState)(!1),h=Object(j.a)(l,2),p=h[0],x=h[1],f=function(){var e=Object(y.a)(S.a.mark((function e(t,n,c,r){var a,i,j,l;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(null),u(!0),e.prev=2,e.next=5,d.createUserWithEmailAndPassword(t,n);case 5:if(a=e.sent){e.next=8;break}throw new Error("Could not complete signup");case 8:return i="thumbnails/".concat(a.user.uid,"/").concat(r.name),e.next=11,O.ref(i).put(r);case 11:return j=e.sent,e.next=14,j.ref.getDownloadURL();case 14:return l=e.sent,e.next=17,a.user.updateProfile({displayName:c,photoURL:l});case 17:return e.next=19,b.collection("users").doc(a.user.uid).set({online:!0,displayName:c,photoURL:l});case 19:o({type:"LOGIN",payload:a.user}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),p||s(e.t0.message);case 25:p||u(!1);case 26:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t,n,c,s){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return function(){return x(!0)}}),[]),{signup:f,error:n,isPending:i}};n(47);function L(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(j.a)(r,2),i=a[0],u=a[1],o=Object(c.useState)(""),l=Object(j.a)(o,2),b=l[0],d=l[1],O=Object(c.useState)(null),p=Object(j.a)(O,2),x=p[0],f=p[1],v=Object(c.useState)(null),m=Object(j.a)(v,2),g=m[0],y=m[1],N=P(),S=N.signup,w=N.isPending,L=N.error;return Object(h.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),S(n,i,b,x)},children:[Object(h.jsx)("h2",{children:"Sign Up"}),Object(h.jsxs)("label",{children:[Object(h.jsx)("span",{children:"Email:"}),Object(h.jsx)("input",{required:!0,type:"email",onChange:function(e){return s(e.target.value)},value:n})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("span",{children:"Password:"}),Object(h.jsx)("input",{required:!0,type:"password",onChange:function(e){return u(e.target.value)},value:i})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("span",{children:"Display Name:"}),Object(h.jsx)("input",{required:!0,type:"text",onChange:function(e){return d(e.target.value)},value:b})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("span",{children:"Profile Thumbnail:"}),Object(h.jsx)("input",{required:!0,type:"file",onChange:function(e){f(null);var t=e.target.files[0];t?t.type.includes("image")?t.size>1e5?y("Image file size must be less than 100KB"):(y(null),f(t)):y("Selected file must be an image"):y("Please select a file")}}),g&&Object(h.jsx)("div",{className:"error",children:g})]}),!w&&Object(h.jsx)("button",{className:"btn",children:"Sign up"}),w&&Object(h.jsx)("button",{className:"btn",disabled:!0,children:"Loading..."}),L&&Object(h.jsx)("div",{className:"error",children:L})]})}n(48);var C=function(){return Object(h.jsx)("div",{children:"Project"})},E=(n(49),n.p+"static/media/temple.c57f882d.svg");function I(){var e=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(j.a)(r,2),i=a[0],u=a[1],o=v(),l=o.dispatch,O=o.user,h=Object(c.useState)(!1),p=Object(j.a)(h,2),x=p[0],f=p[1],m=function(){var e=Object(y.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(null),u(!0),e.prev=2,t=O.uid,e.next=6,b.collection("users").doc(t).update({online:!1});case 6:return e.next=8,d.signOut();case 8:l({type:"LOGOUT"}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),x||s(e.t0.message);case 14:x||u(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return function(){return f(!0)}}),[]),{logout:m,error:n,isPending:i}}(),t=e.logout,n=e.isPending,s=v().user;return Object(h.jsx)("nav",{className:"navbar",children:Object(h.jsxs)("ul",{children:[Object(h.jsxs)("li",{className:"logo",children:[Object(h.jsx)("img",{src:E,alt:"dojo logo"}),Object(h.jsx)("span",{children:"The Dojo"})]}),s?Object(h.jsxs)("li",{children:[!n&&Object(h.jsx)("button",{className:"btn",onClick:t,children:"Logout"}),n&&Object(h.jsx)("button",{className:"btn",disabled:!0,children:"Loggin out..."})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("li",{children:Object(h.jsx)(i.b,{to:"/login",children:"Login"})}),Object(h.jsx)("li",{children:Object(h.jsx)(i.b,{to:"/signup",children:"Signup"})})]})]})})}n(57);function A(e){var t=e.src;return Object(h.jsx)("div",{className:"avatar",children:Object(h.jsx)("img",{src:t,alt:"user avatar"})})}n(58);var R=n.p+"static/media/dashboard_icon.bc800f3b.svg",k=n.p+"static/media/add_icon.376e9b6a.svg";function D(){var e=v().user;return Object(h.jsx)("div",{className:"sidebar",children:Object(h.jsxs)("div",{className:"sidebar-content",children:[Object(h.jsxs)("div",{className:"user",children:[Object(h.jsx)(A,{src:e.photoURL}),Object(h.jsxs)("p",{children:["Hey ",e.displayName]})]}),Object(h.jsx)("nav",{className:"links",children:Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsxs)(i.c,{exact:!0,to:"/",children:[Object(h.jsx)("img",{src:R,alt:"dashboard icon"}),Object(h.jsx)("span",{children:"Dashboard"})]})}),Object(h.jsx)("li",{children:Object(h.jsxs)(i.c,{to:"/create",children:[Object(h.jsx)("img",{src:k,alt:"add project icon"}),Object(h.jsx)("span",{children:"New Project"})]})})]})})]})})}var U=n(28);n(59);function q(){var e=function(e,t,n){var s=Object(c.useState)(null),r=Object(j.a)(s,2),a=r[0],i=r[1],u=Object(c.useState)(null),l=Object(j.a)(u,2),d=l[0],O=l[1],h=Object(c.useRef)(t).current,p=Object(c.useRef)(n).current;return Object(c.useEffect)((function(){var t,n,c=b.collection(e);h&&(c=(t=c).where.apply(t,Object(U.a)(h))),p&&(c=(n=c).orderBy.apply(n,Object(U.a)(p)));var s=c.onSnapshot((function(e){var t=[];e.docs.forEach((function(e){t.push(Object(o.a)({id:e.id},e.data()))})),i(t),O(null)}),(function(e){console.log(e),O("Could not fetch the data")}));return function(){return s()}}),[e,h,p]),{documents:a,error:d}}("users"),t=e.isPending,n=e.error,s=e.documents;return Object(h.jsxs)("div",{className:"user-list",children:[Object(h.jsx)("h2",{children:"All Users"}),t&&Object(h.jsx)("div",{children:"Loading users..."}),n&&Object(h.jsx)("div",{children:n}),s&&s.map((function(e){return Object(h.jsxs)("div",{className:"user-list-item",children:[e.online&&Object(h.jsx)("span",{className:"online-user"}),Object(h.jsx)("span",{children:e.displayName}),Object(h.jsx)(A,{src:e.photoURL})]},e.id)}))]})}var T=function(){var e=v(),t=e.user,n=e.authIsReady;return Object(h.jsx)("div",{className:"App",children:n&&Object(h.jsxs)(i.a,{basename:"/the-dojo",children:[t&&Object(h.jsx)(D,{}),Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)(I,{}),Object(h.jsxs)(u.d,{children:[Object(h.jsxs)(u.b,{exact:!0,path:"/",children:[!t&&Object(h.jsx)(u.a,{to:"/login"}),t&&Object(h.jsx)(m,{})]}),Object(h.jsxs)(u.b,{path:"/create",children:[!t&&Object(h.jsx)(u.a,{to:"/login"}),t&&Object(h.jsx)(g,{})]}),Object(h.jsxs)(u.b,{path:"/login",children:[!t&&Object(h.jsx)(w,{}),t&&Object(h.jsx)(u.a,{to:"/"})]}),Object(h.jsxs)(u.b,{path:"/signup",children:[!t&&Object(h.jsx)(L,{}),t&&Object(h.jsx)(u.a,{to:"/"})]}),Object(h.jsxs)(u.b,{path:"/project/:id",children:[!t&&Object(h.jsx)(u.a,{to:"/login"}),t&&Object(h.jsx)(C,{})]})]})]}),t&&Object(h.jsx)(q,{})]})})};a.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(f,{children:Object(h.jsx)(T,{})})}),document.getElementById("root"))}},[[60,1,2]]]);
//# sourceMappingURL=main.7390e614.chunk.js.map